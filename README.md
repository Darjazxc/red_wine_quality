# Предсказание качества красного вина | Red Wine Quality Prediction

> Машинное обучение для прогнозирования качества вина на основе физико-химических свойств


---

## Описание проекта

Данный проект исследует возможность предсказания качества красного вина на основе его физико-химических характеристик с использованием методов машинного обучения. Проект включает полный цикл data science: от исследовательского анализа данных до построения и оптимизации моделей машинного обучения.

### Основной вопрос исследования:
**Можно ли точно предсказать качество красного вина на основе его физико-химических свойств?**

### Дополнительные вопросы:
- Какие характеристики наиболее важны для качества вина?
- Какая модель машинного обучения показывает лучшую точность?
- Какие рекомендации можно дать производителям вина?

---

## Набор данных

**Источник:** Wine Quality Dataset (Portuguese "Vinho Verde" red wine)

**Размер:** 1599 образцов красного вина

**Период:** Данные собраны для исследования португальского вина "Vinho Verde"

**Ссылка на источник:** P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. "Modeling wine preferences by data mining from physicochemical properties." Decision Support Systems, Elsevier, 47(4):547-553, 2009.

### Переменные датасета:

**Целевая переменная:**
- `quality` — качество вина (шкала от 3 до 8)

**Признаки (11 физико-химических характеристик):**
- `fixed acidity` — фиксированная кислотность (г/дм³)
- `volatile acidity` — летучая кислотность (г/дм³)
- `citric acid` — лимонная кислота (г/дм³)
- `residual sugar` — остаточный сахар (г/дм³)
- `chlorides` — хлориды (г/дм³)
- `free sulfur dioxide` — свободный SO₂ (мг/дм³)
- `total sulfur dioxide` — общий SO₂ (мг/дм³)
- `density` — плотность (г/см³)
- `pH` — кислотность (безразмерная)
- `sulphates` — сульфаты (г/дм³)
- `alcohol` — содержание алкоголя (% об.)

---

## Технологии и инструменты

```python
- Python 3.9
- Pandas — обработка данных
- NumPy — численные вычисления
- Matplotlib / Seaborn — визуализация
- Scikit-learn — машинное обучение
  - Linear Regression
  - Random Forest
  - Gradient Boosting
  - StandardScaler
  - GridSearchCV
```

---

## Методология исследования

### 1. Исследовательский анализ данных (EDA)
- Анализ распределений переменных
- Проверка на пропущенные значения и выбросы
- Корреляционный анализ
- Визуализация взаимосвязей между признаками

### 2. Предобработка данных
- Обработка выбросов
- Стандартизация признаков (StandardScaler)
- Разделение на train/test выборки

### 3. Построение базовой модели (Baseline)
- Простое предсказание средним значением для оценки минимальной точности

### 4. Построение моделей машинного обучения
- **Linear Regression** — линейная регрессия (полная и редуцированная модели)
- **Random Forest** — ансамбль деревьев решений
- **Gradient Boosting** — градиентный бустинг

### 5. Оптимизация гиперпараметров
- GridSearchCV для тонкой настройки Random Forest и Gradient Boosting
- Сравнение моделей по метрикам MAE, RMSE, R²

### 6. Анализ важности признаков
- Feature importance для выявления ключевых факторов качества вина

---

## Результаты

### Сравнение моделей:

Лучшая модель: Gradient Boosting (Tuned)
- **MAE:** 0.387 (средняя ошибка менее 0.4 балла)
- **R²:** 0.508 (модель объясняет ~51% вариации качества)
- **Улучшение:** 43.1% по сравнению с baseline

### Ключевые выводы:

**Подтвержденные гипотезы:**

1. **Алкоголь** — самый важный фактор качества (положительная корреляция)
2. **Летучая кислотность** — главный негативный фактор (отрицательная корреляция)
3. **Сульфаты** — важны для стабильности и качества (положительная корреляция)

**Рекомендации для производителей:**
- Контролировать содержание алкоголя — ключевой фактор качества
- Минимизировать летучую кислотность — главный негативный фактор
- Оптимизировать уровень сульфатов — важно для стабильности вина

---

## Как запустить проект

### Требования:
```bash
pip install -r requirements_vine.txt
```

### Запуск:
1. Клонируйте репозиторий:
```bash
git clone https://github.com/Darjazxc/red_wine_quality.git
cd red_wine_quality
```

2. Откройте notebook:
```bash
jupyter notebook red_wine.ipynb
```

---

## Навыки, продемонстрированные в проекте

- Exploratory Data Analysis (EDA)
- Визуализация данных
- Feature Engineering
- Машинное обучение (регрессия)
- Ансамблевые методы (Random Forest, Gradient Boosting)
- Оптимизация гиперпараметров (GridSearchCV)
- Оценка моделей (MAE, RMSE, R²)
- Анализ важности признаков
- Интерпретация результатов
- Бизнес-рекомендации на основе данных

---

## Ограничения исследования

- Данные ограничены португальским вином "Vinho Verde"
- Субъективность экспертных оценок качества
- Ограниченный диапазон оценок (3-8 из возможных 0-10)
- Несбалансированность классов (большинство вин имеют оценку 5-6)

---

## Лицензия

MIT License - проект доступен для использования в образовательных целях.
